<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta name="description" content="Portfolio homepage">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Homepage </title>
    <link rel="stylesheet" href="index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>
<body data-theme="dark">

    <header>
        <nav>
            <!-- hamburger menu symbols -->
            <label for="menu" >
                <span> </span>
                <span> </span>
                <span> </span>
            </label>
            <input id="menu" type="checkbox" >
            <ul class="navbar-elements">
                <li><a href="index.html">Homepage</a></li>
                <li><a href="resumePage.html">Resume</a></li>
                <li><a href="experiencePage.html">Experience</a></li>
                <li><a href="projectsPage.html">Projects</a></li>
                <li><a href="lifePage.html">Peek into my life!</a></li>
            </ul>

            <!-- reference for theme toggle: https://codepen.io/Umer_Farooq/pen/eYJgKGN -->
            <div id="toggle-switch">
                <input type="checkbox" class="checkbox" id="checkbox">
                <label for="checkbox" class="checkbox-label">
                    <img src="https://assets.streamlinehq.com/image/private/w_512,h_512,ar_1/f_auto/v1/icons/freebies-freemojis/animals-nature/animals-nature/crescent-moon-c6qazn5ca4ut0m5puxm48.png?_a=DATAdtfiZAA0" id="dark" alt="dark mode">
                    <img src="https://cdn-icons-png.freepik.com/512/10493/10493294.png" id="light" alt="light mode">
                <span class="ball"></span>
                </label>
            </div>

        </nav>

        <noscript>
            <p> Javascript is disabled on this page. Your mode preference will not be saved! </p>
        </noscript>

        <script>
            const checkbox = document.getElementById("checkbox");

            document.addEventListener("DOMContentLoaded", () => {
                // checks to see what localStorage has saved
                const isDarkMode = localStorage.getItem("darkMode") == "true";
                checkbox.checked = isDarkMode;

                if(isDarkMode) {
                    document.body.classList.add("light");
                }
                else {
                    document.body.classList.remove("light");
                }
            });

            checkbox.addEventListener("change", () => {
                document.body.classList.toggle("light");
                localStorage.setItem("darkMode", checkbox.checked);
            });

        </script>

    </header>

    <div id="scroll-container">

        <main class="section" id="main-content">
            <img src="../assets/disneyHeadshot.jpg" alt="Headshot of Haley Nguyen" width="300" height="450" class="headshot">

            <div id="main-text">
                <h1> Hello, <br> I'm Haley Nguyen. </h1>
                <p> Welcome to my portfolio! </p>
            </div>

        </main>

        <section class="section" id="about-me">
            <h2> About Me </h2>
            <p>
                I am a third-year student at the University of California - San Diego <abbr>(UCSD)</abbr> majoring in
                <span> computer science </span> with a minor in <span>business analytics </span> and <span>design</span> who is determined to gain more experience in the STEM industry.
                I hope to apply coursework knowledge in a meaningful way and learn about the similarities and differences between industry and classroom work. 
                Open to learning a variety of new/unique coding languages.
            </p>
        </section>


        <section class="section" id="contact-info">
            <h2> <strong> Contact Me! </strong></h2>
            <address>
                <a href="mailto:haley.nguyen821@gmail.com">haley.nguyen821@gmail.com</a> <br>
                <a href="tel:+18183193961"> +1 (818) 319 - 3961 </a>
            </address>

            <div id="quickContact">
                <p>Fill out this form to send me a quick message</p>
                <form action="https://httpbin.org/post" method="post" id="actualForm">
                    <fieldset> 
                        <legend>Contact Information</legend>

                        <input type="hidden" name="form-errors" id="form-errors"/>
                        
                        <!-- pattern was obtained from claude.ai -->
                        <label for="name">Name <span>*</span> 
                            <input 
                                type="text"
                                name="name"
                                id="name"
                                required
                                class="formElement"
                                pattern="^[A-Za-z \-]+$"
                                placeholder="Type your name!"/>
                            <output id="nameError"> </output>
                        </label>

                        <label for="email">Email address <span>*</span> 
                            <input
                                type="email"
                                name="email"
                                id="email"
                                required
                                class="formElement"
                                placeholder="Enter your email address!"/>
                            <output id="emailError"></output>
                        </label>

                        <label for="email">Company name 
                            <input
                                type="text"
                                name="companyName"
                                id="companyName"
                                class="formElement"
                                placeholder="Enter your company name!"/>
                        </label>

                        <label for="message">What message do you want to send? <span>* </span> 
                            <div id="message-comments">
                                <textarea id="message" name="message" rows="5"  cols="33" placeholder="Type your message here..." minlength="1" maxlength="200" required></textarea>
                                <output id="errorMessage"></output>
                                <output id="infoMessage"></output>
                            </div>
                        </label> 

                        <div class="submit">
                            <input type="submit" value="Send Message"/>
                        </div>

                    </fieldset>
                </form> 
            </div>

        </section>
        
    </div>

    <footer>
        <a href="https://www.linkedin.com/in/haley-nguyen-409bb2258/"><img src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn icon"></a>
        <a href="https://github.com/nguyenhaley"><img src="https://static-00.iconduck.com/assets.00/github-inverted-icon-1024x996-daf8vdjl.png" alt="Github icon"></a>
        <a href="https://www.instagram.com/n.haley_/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/1200px-Instagram_icon.png" alt="Instagram icon"></a>
    </footer>


    <script>
        // improved validation
        // keeping track of errors in form
        const form = document.getElementById('actualForm');
        const errorForm = document.getElementById('form-errors');
        let form_errors = [];

        // adds errors to array
        function addError (fieldName, type, message) {
            const error = {
                field: fieldName, 
                type: type, 
                errorMessage: message
            };

            form_errors.push(error);
            errorForm.value = JSON.stringify(form_errors);
        };

        // checking name field errors
        const name = document.getElementById('name');
        const nameError = document.getElementById('nameError');

        name.addEventListener('input', () => {
            if(name.validity.patternMismatch){
                showNameError();
            }
            else if (name.validity.valueMissing) {
                showNameError();
            }
            else {
                nameError.textContent = '';
                nameError.className = '';
            }
        });

        function showNameError () {
            if(name.validity.valueMissing) {
                nameError.textContent = 'You need to enter something!';
                nameError.className = 'error active';
                addError('name', 'valueMissing', 'You need to enter something!');
            } else if (name.validity.patternMismatch){
                nameError.textContent = 'Only letters, spaces, and hyphens are allowed!';
                nameError.className = 'error active';
                addError('name', 'patternMismatch', 'Only letters, spaces, and hyphens are allowed!');
            }
        }

        // checking email field errors
        const email = document.getElementById("email");
        const emailError = document.getElementById("emailError");

        email.addEventListener('input', () => {
            if (email.validity.typeMismatch){
                showEmailError();
            }
            else if (email.validity.valueMissing) {
                showEmailError();
            }
            else {
                emailError.textContent = '';
                emailError.className = '';
            }
        });

        function showEmailError () {
            if(email.validity.valueMissing) {
                emailError.textContent = "You need to enter something!";
                emailError.className = "error active";
                addError('email', 'valueMissing', 'You need to enter something!');
            } else if (email.validity.typeMismatch){
                emailError.textContent = "Please enter a valid email!";
                emailError.className = "error active";
                addError('email', 'typeMismatch', 'Please enter a valid email!');
            }
        }

        // checking textarea field errors
        const message = document.getElementById('message');
        const errorMessage = document.getElementById('errorMessage');
        const infoMessage = document.getElementById('infoMessage');

        // found this regular expression through chatGPT 
        const pattern = /^[a-zA-Z0-9\s.,!?'-]*$/;
        let errorTimeout;

        // chatGPT helped me figure out how to get around lack of pattern attribute for textarea 
        message.addEventListener('input', (event) => {
            let currentText = event.target.value;
            let newText = '';

            for (let i = 0; i < currentText.length; i++) {
                if (pattern.test(currentText[i])) {
                    newText += currentText[i];
                }
            }
        
            if(newText !== currentText){
                errorMessage.textContent = 'Invalid character detected!';
                errorMessage.className = 'visible';
                addError('message', 'invalidCharacter', 'Invalid character detected!');
            }
            else {
                errorMessage.textContent = ''; 
                errorMessage.className = ''; 
            }

            event.target.value = newText;

            // gets rid of error message after 1.5s
            clearTimeout(errorTimeout);
            errorTimeout = setTimeout(() => {
                errorMessage.className = '';
            }, 1500);

        });

        // referenced this for help with code: https://stackoverflow.com/questions/5371089/count-characters-in-textarea
        const maxLength = message.getAttribute('maxlength');

        message.addEventListener('input', () => {
            let currentLength = message.value.length;
            let remainingChars = maxLength - currentLength;

            // updates info message based on how much character limit is less
            infoMessage.textContent = `${remainingChars} characters remaining`; 

            if(currentLength < 1){
                infoMessage.textContent = 'You need at least 1 character!';
                infoMessage.className = 'error';
                addError('message', 'below_char_requirement', 'You need to have at least 1 character in this field!')
            }
            else if (remainingChars <= 10) {
                infoMessage.className = 'error';
                addError('message', 'char_limit_error', 'You have 10 or less characters left!');
            }
            else if (remainingChars <= 20) {
                infoMessage.className = 'warning';
                addError('message', 'char_limit_warning', 'You have 20 or less characters left!');
            }
            else {
                infoMessage.className = 'default';
            }
        });

        errorForm.value = JSON.stringify(form_errors);

        // form submission handling
        // referenced this: https://stackoverflow.com/questions/65509903/how-to-validate-form-with-js-and-store-errors
        //form.addEventListener('submit', () => {
            //form_errors = [];

            //if(name.validity.patternMismatch || name.validity.valueMissing){
                //showNameError();
            //}
            //if(email.validity.typeMismatch || email.validity.valueMissing){
                //showEmailError();
            //}
            //if(message.value.length > maxLength){
                //addError('message', 'char_limit_exceeded', 'Character limit exceeded!');
            //}
            //if(message.value.length < 1){
                //addError('message', 'below_char_requirement', 'You need at least 1 character!');
            //}

            //errorForm.value = JSON.stringify(form_errors);
        //});
        
    </script>

</body>
</html>